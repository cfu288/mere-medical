import { TDateISO } from './Date';

export type ClinicalDocumentResourceType =
  | 'allergyintolerance'
  | 'appointment'
  | 'careplan'
  | 'careteam'
  | 'condition'
  | 'consent'
  | 'contract'
  | 'coverage'
  | 'device'
  | 'diagnosticreport'
  | 'documentreference'
  | 'documentreference_attachment'
  | 'encounter'
  | 'familymemberhistory'
  | 'goal'
  | 'immunization'
  | 'insuranceplan'
  | 'location'
  | 'media'
  | 'medicationadministration'
  | 'medicationdispense'
  | 'medicationrequest'
  | 'medicationstatement'
  | 'nutritionorder'
  | 'observation'
  | 'organization'
  | 'patient'
  | 'person'
  | 'practitioner'
  | 'practitionerrole'
  | 'procedure'
  | 'provenance'
  | 'questionnaire'
  | 'questionnaireresponse'
  | 'relatedperson'
  | 'schedule'
  | 'servicerequest'
  | 'slot'
  | 'specimen';

export interface ClinicalDocument<T = unknown> {
  id: string; // This gets autogenerated, see ClinicalDocument.schema.ts
  connection_record_id: string;
  user_id: string;
  data_record: {
    raw: T;
    format: 'FHIR.DSTU2' | 'FHIR.R4';
    content_type: 'application/json' | 'application/xml' | string;
    resource_type: ClinicalDocumentResourceType;
    version_history: T[];
  };
  metadata?: {
    id?: string;
    date?: TDateISO | string;
    display_name?: string;
    loinc_coding?: string[];
  };
}

export type CreateClinicalDocument<T> = Omit<ClinicalDocument<T>, 'id'>;

export interface MergeClinicalDocument<T> extends ClinicalDocument {
  data_items?: T[];
}
